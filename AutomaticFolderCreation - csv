<# Script to create user folders from a CSV file #>
Clear-Host

"This script creates folders from a .CSV file"

$Continue = Read-Host -Prompt "Do you want to continue running this script?"
if ($continue -eq "Y" -eq "y") {$null; Clear-Host}
if ($Continue -eq "N" -eq "n") {Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/Sagaichi/Powershell/main/AutomationScripts.ps1'))}

Clear-Host

# Open file dialog
# Load Windows Forms
[System.Reflection.Assembly]::LoadWithPartialName("System.windows.forms") | Out-Null

# Create and show open file dialog
$dialog = New-Object System.Windows.Forms.OpenFileDialog
$dialog.InitialDirectory = $StartDir
$dialog.Filter = "CSV (*.csv)| *.csv" 
$dialog.ShowDialog() | Out-Null

# Get file path
$CSVFile = $dialog.FileName

# Import file into variable
# Lets make sure the file path was valid
# If the file path is not valid, then exit the script
if ([System.IO.File]::Exists($CSVFile)) {
    Write-Host "Importing CSV..."
    $Folder = Import-Csv -LiteralPath "$CSVFile"
} else {
    Write-Host "File path specified was not valid"
    Exit
}

# Location Where your folders are to be created

#Set-Location "$path"

# Import CSV file from location

$CSV =  Read-Host -prompt "Paste the path to the CSV Here"

$Folders = Import-Csv "$CSV"

# Create Folders from CSV ensure you have a heading of Name in your CSV file
 
ForEach ($Folder in $Folders) { 
 
New-Item "$($Folder.Name)-$($Folder.ID)" -type directory 
}  